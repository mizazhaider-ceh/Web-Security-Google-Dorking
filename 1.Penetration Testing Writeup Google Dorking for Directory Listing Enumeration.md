# Penetration Testing Writeup: Google Dorking for Directory Listing Enumeration

> **Note on Terminology**: In penetration testing and bug bounty hunting, a "writeup" is the standard term for detailed technical documentation of vulnerability discovery, exploitation methodology, and security findings. This format allows security professionals to share knowledge, demonstrate impact, and provide actionable remediation guidance.

***

## üìã Engagement Overview

| **Test Type** | OSINT / Reconnaissance - Directory Listing Enumeration |
| :-- | :-- |
| **Methodology** | Google Dorking (GHDB Technique) |
| **Target Domain** | target.com |
| **Test Date** | 2025-12-27 |
| **Tester Role** | External Black Box Assessment |
| **Severity** | High (Sensitive Data Exposure) |


***

## üéØ Executive Summary

During reconnaissance operations against `target.com`, Google Dorking techniques successfully identified a critical misconfiguration: publicly accessible directory listings exposing sensitive application files. The most severe finding was a database configuration file (`database.yml`) containing hardcoded root credentials in plaintext. This represents a direct path to full database compromise, meeting the criteria for immediate remediation.

**Key Impact**: Unauthorized database access, potential data breach, credential exposure, and application compromise.

***

## üîç Reconnaissance Phase: Google Dorking Methodology

### Understanding Google Dorking

Google Dorking (also called Google Hacking) leverages Google's advanced search operators to discover publicly indexed information that may reveal security vulnerabilities. By crafting specific queries, penetration testers can identify misconfigurations, exposed files, and sensitive data before ever directly interacting with the target application.

### Core Concept: Why "Index of" Matters

When a web server has directory listing enabled and no index file (like `index.html` or `index.php`) exists in a directory, the server automatically generates a page displaying all files and subdirectories. These pages typically have a title containing "Index of" followed by the directory path. Google indexes these pages like any other content, making them searchable.

***

## üõ†Ô∏è Primary Google Dork Query Analysis

### Query Used in Demonstration

```
site:target.com AND intitle:"Index of"
```


### Query Component Breakdown

| **Operator** | **Function** | **Pentester Value** |
| :-- | :-- | :-- |
| `site:` | Restricts results to specific domain/subdomain  | Focuses reconnaissance on authorized scope; prevents testing out-of-scope assets |
| `AND` | Boolean operator requiring both conditions  | Combines multiple search criteria for precision targeting |
| `intitle:` | Searches for keywords within HTML `<title>` tag  | Identifies pages with specific titles indicating directory listings |
| `"Index of"` | Exact phrase match (case-insensitive)  | Targets the default title text generated by directory listing pages  |

### Why This Query Works

When directory listing is enabled, web servers (Apache, Nginx, IIS) generate an HTML page with a predictable title format:

```html
<title>Index of /files/</title>
<title>Index of /backup/</title>
<title>Index of /config/</title>
```

Google's indexing crawlers discover and catalog these pages, making them searchable through dorking queries.

***

## üî• Extended Google Dork Arsenal for Directory Listings

### Variation 1: Multiple Index Indicators

```
site:target.com (intitle:"index of" | intitle:"directory listing")
```

**Pentester Benefit**: Catches variations in server configurations that may use different title formats.

### Variation 2: Parent Directory

```
site:target.com intitle:"index of" "parent directory"
```

**Pentester Benefit**: The phrase "parent directory" appears in directory listing pages and confirms the finding is a genuine directory listing, not a false positive.

### Variation 3: Targeting Specific Sensitive Directories

```
site:target.com intitle:"index of" (backup | config | admin | private | logs)
```

**Pentester Benefit**: Narrows search to high-value directories commonly containing sensitive data.

### Variation 4: File Extension Hunting

```
site:target.com intitle:"index of" (*.yml | *.env | *.config | *.sql | *.bak)
```

**Pentester Benefit**: Directly targets configuration files, database dumps, and backup files frequently found in exposed directories.

### Variation 5: Time-Based Discovery

```
site:target.com intitle:"index of" "last modified"
```

**Pentester Benefit**: Confirms recent activity and helps identify actively maintained directories versus legacy forgotten paths.

### Variation 6: Combining with Subdomain Enumeration

```
site:*.target.com intitle:"index of"
```

**Pentester Benefit**: Expands scope to discover exposed directories across all subdomains, which may have different security configurations.

***

## üé¨ Step-by-Step Attack Execution

### Phase 1: Initial Reconnaissance

**Objective**: Identify if directory listing is enabled on the target domain.

**Action Taken**:

1. Constructed Google Dork query: `site:target.com AND intitle:"Index of"`
2. Executed search in Google Search interface
3. Analyzed search results for indexed directories

**Result**: Google returned indexed directories with directory listing enabled.

### Phase 2: Target Identification

**Discovered Directory**: `/files/`

**Indicators**:

- Page title contained "Index of /files/"
- Directory structure visible with file names and metadata
- Public accessibility confirmed (no authentication required)

**Pentester Analysis**: The `/files/` directory name suggests a generic file storage location, often used for uploads, configurations, or temporary storage. This is a prime target for sensitive data discovery.

### Phase 3: File Enumeration

**Action**: Accessed the directory listing page directly via browser.

**Findings**:

- **File Discovered**: `database.yml`
- **File Type**: YAML configuration file (common in Ruby on Rails, Python, and other frameworks)
- **Risk Indicator**: Database configuration files typically contain connection strings, usernames, and passwords

**Pentester Insight**: The `.yml` extension indicates a configuration file in YAML format, commonly used for application settings. Files named `database.yml` are particularly critical as they store database credentials for application connectivity.

### Phase 4: Content Analysis

**Action**: Accessed the file directly by clicking on it in the directory listing.

**Extracted Credentials**:

```yaml
username: root
password: super secure password
```

**Critical Finding**:

- Username: `root` (highest privilege MySQL/MariaDB account)
- Password: Plain text, no encryption or hashing
- Password quality: While labeled "super secure password," it's a multi-word password but still exposed in plaintext

**Pentester Assessment**: Root-level database credentials provide complete control over the database, including:

- Full read/write access to all tables and databases
- Ability to create/delete databases and users
- Potential for privilege escalation to operating system level (via SQL functions like `INTO OUTFILE`, `LOAD_FILE()`)
- Complete data exfiltration capability

***

## üö® Impact Analysis: Pentester Perspective

### Immediate Security Risks

#### 1. **Complete Database Compromise**

With root credentials, an attacker can:

- Extract all user data (PII, passwords, financial information)
- Modify data to inject malicious content or backdoors
- Delete databases causing severe business disruption
- Create new administrative accounts for persistent access


#### 2. **Lateral Movement Opportunities**

Database access often enables:

- Discovery of internal network architecture through stored configuration data
- Access to password hashes of application users
- Identification of other connected services and APIs
- Potential file system access through SQL file operations


#### 3. **Compliance Violations**

This finding likely triggers violations of:

- **GDPR**: Inadequate protection of personal data (Article 32)
- **PCI DSS**: Failure to protect cardholder data (Requirement 6.5)
- **HIPAA**: Insufficient security controls (if health data present)
- **SOC 2**: Control failures in access management and data protection


### Attack Chain Potential

```
Google Dorking Discovery
         ‚Üì
Directory Listing Access
         ‚Üì
Credential Extraction (database.yml)
         ‚Üì
Database Connection
         ‚Üì
Data Exfiltration / Modification
         ‚Üì
Application Takeover / Lateral Movement
```


***

## üïµÔ∏è What Pentesters Should Look For

### In Directory Listings

1. **Configuration Files**
    - `database.yml`, `.env`, `config.php`, `web.config`
    - Connection strings, API keys, secret tokens
    - Third-party service credentials (AWS, Azure, SendGrid)
2. **Backup Files**
    - `.sql`, `.bak`, `.old`, `.backup`, `.tar.gz`
    - Source code archives revealing business logic
    - Database dumps containing sensitive data
3. **Log Files**
    - `error.log`, `access.log`, `debug.log`
    - May contain stack traces with paths and versions
    - Potential exposure of session tokens or credentials in logs
4. **Administrative Files**
    - `admin.php`, `phpinfo.php`, `test.php`
    - Development/debugging files left in production
    - Administrative interfaces not linked from main site
5. **Documentation**
    - `README.md`, `INSTALL.txt`, `TODO.txt`
    - Architecture diagrams, deployment notes
    - Credentials or internal URLs in documentation
6. **Source Code**
    - Exposed Git repositories (`.git/` directories)
    - Application source files revealing vulnerabilities
    - Hardcoded credentials in source code

### Red Flags for High-Value Targets

| **Indicator** | **Significance** |
| :-- | :-- |
| `/backup/` or `/old/` directories | Often forgotten, may contain legacy credentials still valid  |
| Recent "Last Modified" dates | Active development areas with current data  |
| Multiple configuration files | Different environments (dev, staging, prod) may have weaker security |
| Large `.sql` or `.dump` files | Direct database exports with complete data sets |
| `/admin/` or `/private/` in listing | Misconfigured access controls on sensitive areas |


***

## üîß Additional Reconnaissance Techniques

### Combining Google Dorking with Other OSINT

#### 1. **Wayback Machine Cross-Reference**

After finding exposed directories, check historical snapshots:

```
https://web.archive.org/web/*/target.com/files/
```

**Pentester Value**: May reveal previously exposed files that were removed but still exist on server.

#### 2. **Subdomain Enumeration Before Dorking**

Use tools like `theHarvester`, `Amass`, or `Subfinder` to discover subdomains, then dork each:

```bash
# Example workflow
amass enum -d target.com -o subdomains.txt

# Then dork each subdomain
for sub in $(cat subdomains.txt); do
    echo "site:$sub intitle:\"index of\""
done
```

**Pentester Value**: Different subdomains may have different security postures; dev/staging environments often have weaker controls.

#### 3. **Certificate Transparency Logs**

Search CT logs for additional subdomains and domains owned by the organization:

```
https://crt.sh/?q=%.target.com
```

**Pentester Value**: Discovers assets that may not be in DNS or may have been decommissioned but still accessible.

***

## üõ°Ô∏è Remediation Recommendations: Pentester Report Format

### Critical Priority (Fix Immediately)

#### Finding 1: Directory Listing Enabled on `/files/` Directory

**Severity**: High
**CVSS Score**: 7.5 (High) - AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**Remediation**:

**Apache (.htaccess or httpd.conf)**:

```apache
<Directory /var/www/html/files>
    Options -Indexes
</Directory>
```

**Nginx (nginx.conf)**:

```nginx
location /files/ {
    autoindex off;
}
```

**IIS (web.config)**:

```xml
<directoryBrowse enabled="false" />
```

**Verification**: After applying, attempt to access `https://target.com/files/` and confirm it returns 403 Forbidden or 404 Not Found.

#### Finding 2: Sensitive File in Web Root with Plaintext Credentials

**Severity**: Critical
**CVSS Score**: 9.8 (Critical) - AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**Immediate Actions**:

1. **Remove File from Web Root**:

```bash
# Move configuration file outside document root
mv /var/www/html/files/database.yml /etc/app/config/database.yml
chmod 600 /etc/app/config/database.yml
```

2. **Rotate All Credentials**:

```sql
-- Connect to MySQL/MariaDB
ALTER USER 'root'@'localhost' IDENTIFIED BY 'new_complex_password_here';
FLUSH PRIVILEGES;
```

3. **Implement Environment Variables**:

```yaml
# Updated database.yml using environment variables
production:
  adapter: mysql2
  database: <%= ENV['DB_NAME'] %>
  username: <%= ENV['DB_USER'] %>
  password: <%= ENV['DB_PASSWORD'] %>
  host: <%= ENV['DB_HOST'] %>
```

4. **Audit Access Logs**:

```bash
# Check for unauthorized database access
grep "database.yml" /var/log/apache2/access.log
grep "database.yml" /var/log/nginx/access.log

# Check database audit logs for suspicious queries
# Review MySQL general log if enabled
```


**Verification**: Confirm file is no longer accessible via web browser and credentials have been changed in application configuration.

***

## üîê Long-Term Security Hardening

### 1. Search Engine Directives

**robots.txt** (Root of web server):

```
User-agent: *
Disallow: /files/
Disallow: /backup/
Disallow: /config/
Disallow: /logs/
Disallow: /admin/
Disallow: /.git/
```

**Meta Tags** (In sensitive pages):

```html
<meta name="robots" content="noindex, nofollow">
```

**Pentester Note**: `robots.txt` is advisory only; don't rely on it for security, but it reduces indexing of sensitive paths.

### 2. Web Application Firewall (WAF) Rules

Implement rules to detect and block:

- Access to common sensitive file extensions (`.yml`, `.env`, `.config`, `.sql`, `.bak`)
- Directory traversal attempts
- Automated scanning tools (detect by User-Agent, request patterns)


### 3. Security Headers

Add protective headers to prevent information leakage:

```
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000; includeSubDomains
```


### 4. Regular Security Audits

**Automated Google Dorking Against Own Assets**:

Create a scheduled script to test your own infrastructure:

```python
# Pseudo-code example
dork_queries = [
    'site:yourdomain.com intitle:"index of"',
    'site:yourdomain.com ext:yml OR ext:env OR ext:config',
    'site:yourdomain.com inurl:backup OR inurl:old',
]

for query in dork_queries:
    results = google_search(query)
    if results:
        alert_security_team(query, results)
```

**Pentester Recommendation**: Perform quarterly manual Google Dorking assessments as part of your security testing program.

### 5. File System Permissions

Implement proper permissions on sensitive files:

```bash
# Configuration files readable only by application user
chmod 600 /etc/app/config/*
chown appuser:appuser /etc/app/config/*

# Web root with restricted permissions
chmod 755 /var/www/html
chmod 644 /var/www/html/*.php
```


### 6. Configuration Management

**Use Secret Management Tools**:

- **HashiCorp Vault**: Centralized secret storage with access auditing
- **AWS Secrets Manager**: Cloud-native secret rotation
- **Azure Key Vault**: Encrypted secret storage with RBAC
- **Doppler**: Environment variable management platform

**Example Vault Integration**:

```bash
# Application retrieves secrets at runtime
export DB_PASSWORD=$(vault kv get -field=password secret/database)
```


***

## üéØ Additional Google Dork Queries for Comprehensive Testing

### Configuration File Discovery

```
# Environment files
site:example.com ext:env "DB_PASSWORD"

# PHP configuration
site:example.com ext:php intext:"mysql_connect"

# ASP.NET configuration
site:example.com ext:config "connectionStrings"

# Cloud configuration
site:example.com ext:json "aws_access_key_id"
```


### Backup File Discovery

```
# SQL dumps
site:example.com ext:sql "INSERT INTO"

# Compressed backups
site:example.com intitle:"index of" (*.tar.gz | *.zip | *.bak)

# Version control exposure
site:example.com inurl:".git" intitle:"index of"
```


### Authentication Pages

```
# Login pages
site:example.com inurl:login OR inurl:signin OR inurl:auth

# Admin panels
site:example.com inurl:admin intitle:"login"

# API authentication
site:example.com inurl:api/auth OR inurl:api/login
```


### Error Messages and Debug Information

```
# Stack traces
site:example.com intext:"Fatal error" OR intext:"Warning:"

# PHP info exposure
site:example.com ext:php inurl:phpinfo

# Database errors
site:example.com intext:"SQL syntax" OR intext:"mysql_fetch"
```


***

## üìä Pentester's Reconnaissance Checklist

- [ ] Run primary directory listing dork: `site:target.com intitle:"index of"`
- [ ] Test all query variations documented above
- [ ] Enumerate subdomains and dork each individually
- [ ] Search for specific sensitive file types (`.env`, `.yml`, `.config`)
- [ ] Check for exposed backup directories
- [ ] Look for version control directories (`.git`, `.svn`)
- [ ] Search for phpinfo and test pages
- [ ] Hunt for database error messages
- [ ] Identify login/admin panels
- [ ] Cross-reference findings with Wayback Machine
- [ ] Document all findings with screenshots and evidence
- [ ] Test accessibility of discovered resources
- [ ] Extract and analyze any exposed sensitive data
- [ ] Verify if discovered credentials are valid
- [ ] Assess impact and exploitation potential
- [ ] Compile findings into structured report

***

## üß∞ Tools for Automated Google Dorking

### 1. Pagodo (Automated GHDB Scanning)

```bash
# Installation
git clone https://github.com/opsdisk/pagodo.git
cd pagodo
pip3 install -r requirements.txt

# Usage
python3 pagodo.py -d target.com -g dorks.txt -l 50
```

**Pentester Value**: Automates testing of hundreds of GHDB queries against target domain.

### 2. Custom Python Script with googlesearch-python

```python
from googlesearch import search
import time

domain = "target.com"
dorks = [
    f'site:{domain} intitle:"index of"',
    f'site:{domain} ext:env OR ext:yml',
    f'site:{domain} inurl:backup OR inurl:old',
]

for dork in dorks:
    print(f"\n[+] Testing: {dork}")
    try:
        for result in search(dork, num_results=10):
            print(f"  [*] {result}")
        time.sleep(10)  # Avoid rate limiting
    except Exception as e:
        print(f"  [!] Error: {e}")
```

**Pentester Value**: Customizable automation with rate limiting to avoid Google blocking.

### 3. Google Hacking Database (GHDB)

**Resource**: https://www.exploit-db.com/google-hacking-database

**Contains**:

- 5000+ curated Google Dorks
- Categories: Sensitive Files, Login Pages, SQL Errors, Network Devices
- Regular updates with new attack patterns

***

## üìö Additional Resources for Pentesters

| **Resource** | **Description** | **URL** |
| :-- | :-- | :-- |
| GHDB | Official Google Hacking Database | exploit-db.com/google-hacking-database  |
| OWASP WSTG | Web Security Testing Guide | owasp.org/www-project-web-security-testing-guide/ |
| Dorking Cheat Sheet | Comprehensive operator reference | gist.github.com/sundowndev/283efaddbcf896ab405488330d1bbc06  |


***

## üéì Key Takeaways for Penetration Testers

### Why This Technique Matters

1. **Non-Invasive**: Google Dorking is passive reconnaissance that doesn't trigger intrusion detection systems
2. **High ROI**: Minimal effort can uncover critical vulnerabilities before active testing
3. **Scope Expansion**: Discovers assets and attack surface not documented by the client
4. **Real-World Impact**: Demonstrates exploitability that resonates with clients and stakeholders

### How to Use in Engagements

**Black Box Testing**: Begin every engagement with comprehensive Google Dorking to identify low-hanging fruit

**Gray/White Box Testing**: Use to verify client's self-assessment and discover undocumented assets

**Red Team Operations**: Leverage for initial access vectors that mimic real attacker behavior

**Bug Bounty**: Quick wins for information disclosure bounties; combine with subdomain enumeration for comprehensive coverage

### What Makes a Good Finding

A security finding in a penetration test report should include:

1. **Clear Description**: What the vulnerability is and where it exists
2. **Reproducible Steps**: Exact methodology to replicate the finding
3. **Evidence**: Screenshots, command output, and extracted data
4. **Impact Analysis**: Business and technical consequences of exploitation
5. **Remediation**: Specific, actionable fix instructions
6. **Risk Rating**: CVSS score or severity classification

***

## ‚öñÔ∏è Ethical and Legal Considerations

**Authorization**: Always ensure written permission before testing

**Scope Compliance**: Google Dorking can reveal out-of-scope assets; document but don't test without authorization

**Data Handling**: Treat discovered credentials and sensitive data with appropriate confidentiality

**Responsible Disclosure**: If credentials are exposed, recommend immediate rotation and notify client urgently

***

## üèÅ Conclusion

This demonstration showcases the power of Google Dorking as a reconnaissance technique in penetration testing. The discovery of the `database.yml` file with root credentials through a simple, passive OSINT query illustrates how minor misconfigurations can lead to complete system compromise.

For penetration testers, mastering Google Dorking provides:

- **Efficiency**: Rapid identification of vulnerabilities before active testing
- **Coverage**: Discovery of assets and exposures beyond the obvious attack surface
- **Impact**: Demonstrable findings that drive remediation action

The techniques and query variations documented in this writeup should be incorporated into every web application security assessment as part of comprehensive reconnaissance operations.

***

## üìù Appendix: Testing Evidence

### Screenshot 1: Google Search Results

** - Shows the Google Dork query and indexed directory listings

### Screenshot 2: Directory Listing View

** - Exposed `/files/` directory with `database.yml` visible

### Screenshot 3: Credential Exposure

** - Contents of `database.yml` showing plaintext credentials

***

---

## üìù About This Documentation

**Practical Testing Performed By**: Muhammad Izaz Haider

**Course**: EC-Council's Short Course - *Web Application Security Testing with Google Hacking*

**Purpose**: This documentation demonstrates the practical application of Google Dorking techniques learned during the course, transforming theoretical knowledge into hands-on security testing methodologies.

---

*This writeup is intended for educational purposes and authorized security testing only. Unauthorized testing of systems you don't own or have explicit permission to test is illegal.*
